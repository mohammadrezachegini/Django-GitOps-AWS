apiVersion: apps/v1
kind: Deployment
metadata:
  name: django-api
spec:
  replicas: 2    # Run 2 replicas in dev for basic HA
  template:
    spec:
      containers:
        - name: django-api
          # Pull from ECR â€” nodes have IAM permission to pull automatically
          imagePullPolicy: Always
          env:
            - name: DEBUG
              value: "False"
            - name: ALLOWED_HOSTS
              # RDS endpoint + ALB hostname will be added here in Phase 6
              value: "localhost,127.0.0.1"
            - name: DB_HOST
              # RDS endpoint from terraform output
              value: "django-gitops-postgres.czasg4cict9w.us-east-1.rds.amazonaws.com"
            - name: DB_PORT
              value: "5432"